{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "eff11c11",
   "metadata": {},
   "source": [
    "<div style=\"border:solid green 2px; padding: 20px\">\n",
    "    \n",
    "<b>–ö—Ä–∏—Å—Ç–∏–Ω–∞, –ø—Ä–∏–≤–µ—Ç!</b> –ú—ã —Ä–∞–¥—ã —Ç–µ–±—è –≤–∏–¥–µ—Ç—å –Ω–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏ –∫–æ–¥-—Ä–µ–≤—å—é–µ—Ä–æ–≤. üòé –¢—ã –ø—Ä–æ–¥–µ–ª–∞–ª–∞ –±–æ–ª—å—à—É—é —Ä–∞–±–æ—Ç—É –Ω–∞–¥ –ø—Ä–æ–µ–∫—Ç–æ–º, –Ω–æ –¥–∞–≤–∞–π –ø–æ–∑–Ω–∞–∫–æ–º–∏–º—Å—è –∏ —Å–¥–µ–ª–∞–µ–º –µ–≥–æ –µ—â–µ –ª—É—á—à–µ! –£ –Ω–∞—Å —Ç—É—Ç —Å–≤–æ—è –∞—Ç–º–æ—Å—Ñ–µ—Ä–∞ –∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–∞–≤–∏–ª:\n",
    "\n",
    "\n",
    "1. –≠—Ç–æ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä –ú–∞—Ç–≤–µ–µ–≤—Å–∫–∏–π. –Ø —Ä–∞–±–æ—Ç–∞—é –∫–æ–¥-—Ä–µ–≤—å—é–µ—Ä–æ–º, –º–æ—è –æ—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å ‚Äî –Ω–µ —É–∫–∞–∑–∞—Ç—å –Ω–∞ —Å–æ–≤–µ—Ä—à–µ–Ω–Ω—ã–µ —Ç–æ–±–æ—é –æ—à–∏–±–∫–∏, –∞ –ø–æ–¥–µ–ª–∏—Ç—å—Å—è —Å–≤–æ–∏–º –æ–ø—ã—Ç–æ–º –∏ –ø–æ–º–æ—á—å —Ç–µ–±–µ —Å—Ç–∞—Ç—å –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–º –¥–∞–Ω–Ω—ã—Ö.\n",
    "2. –û–±—â–∞–µ–º—Å—è –Ω–∞ —Ç—ã.\n",
    "3. –ï—Å–ª–∏ —Ö–æ—á–µ—à—å –Ω–∞–ø–∏—Å–∞—Ç—å, —Å–ø—Ä–æ—Å–∏—Ç—å - –Ω–µ –Ω—É–∂–Ω–æ —Å—Ç–µ—Å–Ω—è—Ç—å—Å—è. –¢–æ–ª—å–∫–æ –≤—ã–±–µ—Ä–∏ —Å–≤–æ–π —Ü–≤–µ—Ç –¥–ª—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è.  \n",
    "4. –≠—Ç–æ —É—á–µ–±–Ω—ã–π –ø—Ä–æ–µ–∫—Ç, —Ç—É—Ç –º–æ–∂–Ω–æ –Ω–µ –±–æ—è—Ç—å—Å—è —Å–¥–µ–ª–∞—Ç—å –æ—à–∏–±–∫—É.  \n",
    "5. –£ –Ω–∞—Å —Å —Ç–æ–±–æ–π 6 –ø–æ–ø—ã—Ç–æ–∫ –¥–ª—è —Å–¥–∞—á–∏ –ø—Ä–æ–µ–∫—Ç–∞   \n",
    "6. Let's Go!\n",
    "\n",
    "---\n",
    "\n",
    "–Ø –±—É–¥—É –∫—Ä–∞—Å–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —Ü–≤–µ—Ç–æ–º, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–µ —É–¥–∞–ª—è–π –∏—Ö:\n",
    "\n",
    "<div class=\"alert alert-block alert-danger\">‚úç\n",
    "    \n",
    "\n",
    "__–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ—Ç —Ä–µ–≤—å—é–µ—Ä–∞ ‚Ññ1__\n",
    "\n",
    "–¢–∞–∫–æ–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, –æ–Ω –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–ª–∏—è–µ—Ç –Ω–∞ —É–¥–∞—á–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞.\n",
    "</div>\n",
    "    \n",
    "---\n",
    "\n",
    "<div class=\"alert alert-block alert-warning\">üìù\n",
    "    \n",
    "\n",
    "__–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ—Ç —Ä–µ–≤—å—é–µ—Ä–∞ ‚Ññ1__\n",
    "\n",
    "\n",
    "–¢–∞–∫–æ–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —è–≤–ª—è–µ—Ç—Å—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–µ–π –∏–ª–∏ —Å–æ–≤–µ—Ç–æ–º. –ú–æ–∂–µ—à—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏—Ö –Ω–∞ —Å–≤–æ—ë —É—Å–º–æ—Ç—Ä–µ–Ω–∏–µ.\n",
    "</div>\n",
    "\n",
    "---\n",
    "\n",
    "<div class=\"alert alert-block alert-success\">‚úîÔ∏è\n",
    "    \n",
    "\n",
    "__–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ—Ç —Ä–µ–≤—å—é–µ—Ä–∞ ‚Ññ1__\n",
    "\n",
    "–¢–∞–∫–æ–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π  –≥–æ–≤–æ—Ä–∏—Ç –æ —Ç–æ–º, —á—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ —á—Ç–æ-—Ç–æ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ =)\n",
    "</div>\n",
    "    \n",
    "---\n",
    "    \n",
    "–ü—Ä–µ–¥–ª–∞–≥–∞—é —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞–¥ –ø—Ä–æ–µ–∫—Ç–æ–º –≤ –¥–∏–∞–ª–æ–≥–µ: –µ—Å–ª–∏ —Ç—ã —á—Ç–æ-—Ç–æ –º–µ–Ω—è–µ—à—å –≤ –ø—Ä–æ–µ–∫—Ç–µ –∏–ª–∏ –æ—Ç–≤–µ—á–∞–µ—à—å –Ω–∞ –º–æ–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ ‚Äî –ø–∏—à–∏ –æ–± —ç—Ç–æ–º. –ú–Ω–µ –±—É–¥–µ—Ç –ª–µ–≥—á–µ –æ—Ç—Å–ª–µ–¥–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è, –µ—Å–ª–∏ —Ç—ã –≤—ã–¥–µ–ª–∏—à—å —Å–≤–æ–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏:   \n",
    "    \n",
    "<div class=\"alert alert-info\"> <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞:</b> –ù–∞–ø—Ä–∏–º–µ—Ä, –≤–æ—Ç —Ç–∞–∫.</div>\n",
    "    \n",
    "–í—Å—ë —ç—Ç–æ –ø–æ–º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É —Ç–≤–æ–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–µ–µ. –ï—Å–ª–∏ –±—É–¥—É—Ç –∫–∞–∫–∏–µ-–Ω–∏–±—É–¥—å –≤–æ–ø—Ä–æ—Å—ã –ø–æ –º–æ–∏–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º, –ø–∏—à–∏, –±—É–¥–µ–º —Ä–∞–∑–±–∏—Ä–∞—Ç—å—Å—è –≤–º–µ—Å—Ç–µ :)    \n",
    "    \n",
    "---"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "_E41Wr5fqnFT",
   "metadata": {
    "id": "_E41Wr5fqnFT"
   },
   "source": [
    "# –ß–∞—Å—Ç—å 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–∏–ø–æ—Ç–µ–∑—ã –≤ Python –∏ —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–π –∑–∞–ø–∏—Å–∫–∏"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "Z5_6nf-FrY7o",
   "metadata": {
    "id": "Z5_6nf-FrY7o"
   },
   "source": [
    "–í—ã –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∞–ª–∏ –¥–∞–Ω–Ω—ã–µ –≤ SQL, –∏ —Ç–µ–ø–µ—Ä—å –æ–Ω–∏ –≥–æ—Ç–æ–≤—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≥–∏–ø–æ—Ç–µ–∑—ã –≤ Python. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ –ú–æ—Å–∫–≤—ã –∏ –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥–∞ c —Å—É–º–º–æ–π —á–∞—Å–æ–≤ –∏—Ö –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏–∑ —Ñ–∞–π–ª–∞ yandex_knigi_data.csv. –ï—Å–ª–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç–µ –ª–æ–∫–∞–ª—å–Ω–æ, —Å–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª –º–æ–∂–Ω–æ –ø–æ —Å—Å—ã–ª–∫–µ.\n",
    "\n",
    "–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –≤ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –°—Ä–∞–≤–Ω–∏—Ç–µ —Ä–∞–∑–º–µ—Ä—ã –≥—Ä—É–ø–ø, –∏—Ö —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ.\n",
    "\n",
    "–ù–∞–ø–æ–º–Ω–∏–º, –∫–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç –≥–∏–ø–æ—Ç–µ–∑–∞: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–∑ –ú–æ—Å–∫–≤—ã –ø—Ä–æ–≤–æ–¥—è—Ç –≤ —Å—Ä–µ–¥–Ω–µ–º –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞ —á—Ç–µ–Ω–∏–µ–º –∏ –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–µ–º –∫–Ω–∏–≥ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏, —á–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–∑ –ú–æ—Å–∫–≤—ã. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ —ç—Ç–æ –¥–æ–∫–∞–∑–∞—Ç—å, –∏—Å–ø–æ–ª—å–∑—É—è –æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω—é—é –ø—Ä–æ–≤–µ—Ä–∫—É –≥–∏–ø–æ—Ç–µ–∑—ã —Å –¥–≤—É–º—è –≤—ã–±–æ—Ä–∫–∞–º–∏:\n",
    "\n",
    "–ù—É–ª–µ–≤–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞ $H_0: \\mu_{\\text{–°–ü–±}} \\leq \\mu_{\\text{–ú–æ—Å–∫–≤–∞}}$ <br> –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥–µ –Ω–µ –±–æ–ª—å—à–µ, —á–µ–º –≤ –ú–æ—Å–∫–≤–µ.\n",
    "\n",
    "–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞ $H_1: \\mu_{\\text{–°–ü–±}} > \\mu_{\\text{–ú–æ—Å–∫–≤–∞}}$ <br> –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥–µ –±–æ–ª—å—à–µ, –∏ —ç—Ç–æ —Ä–∞–∑–ª–∏—á–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º–æ.\n",
    "\n",
    "–ü–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫—É—é –∑–∞–ø–∏—Å–∫—É, –≤ –∫–æ—Ç–æ—Ä–æ–π –æ–ø–∏—à–∏—Ç–µ:\n",
    "\n",
    "–í—ã–±—Ä–∞–Ω–Ω—ã–π —Ç–∏–ø t-—Ç–µ—Å—Ç–∞ –∏ —É—Ä–æ–≤–µ–Ω—å —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏.\n",
    "\n",
    "–†–µ–∑—É–ª—å—Ç–∞—Ç —Ç–µ—Å—Ç–∞, –∏–ª–∏ p-value.\n",
    "\n",
    "–í—ã–≤–æ–¥ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ p-value, —Ç–æ –µ—Å—Ç—å –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—é —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.\n",
    "\n",
    "–û–¥–Ω—É –∏–ª–∏ –¥–≤–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã, –æ–±—ä—è—Å–Ω—è—é—â–∏–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1f753408",
   "metadata": {},
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "e06910dd",
   "metadata": {
    "id": "e06910dd"
   },
   "source": [
    "## –ê–Ω–∞–ª–∏–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ¬´–Ø–Ω–¥–µ–∫—Å.–ö–Ω–∏–≥–∏¬ª\n",
    "\n",
    "- –ê–≤—Ç–æ—Ä: –ö—Ä–∏—Å—Ç–∏–Ω–∞ –í–∞–≤–∏–ª–∏–Ω–∞\n",
    "- –î–∞—Ç–∞: 15.04.2025 –≥–æ–¥–∞"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4149134c",
   "metadata": {
    "id": "4149134c"
   },
   "source": [
    "## –¶–µ–ª–∏ –∏ –∑–∞–¥–∞—á–∏ –ø—Ä–æ–µ–∫—Ç–∞\n",
    "**–¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞:**\n",
    "\n",
    "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º—É—é —Ä–∞–∑–Ω–∏—Ü—É –≤ —Å—Ä–µ–¥–Ω–µ–º –≤—Ä–µ–º–µ–Ω–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è ¬´–Ø–Ω–¥–µ–∫—Å.–ö–Ω–∏–≥–∏¬ª –º–µ–∂–¥—É –∂–∏—Ç–µ–ª—è–º–∏ –ú–æ—Å–∫–≤—ã –∏ –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥–∞.\n",
    "\n",
    "**–ó–∞–¥–∞—á–∏:**\n",
    "\n",
    "- –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –¥–∞–Ω–Ω—ã–µ, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –∏ –ø—Ä–æ–ø—É—Å–∫–æ–≤.\n",
    "- –ü—Ä–æ–≤–µ—Å—Ç–∏ –æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–∏–π t-—Ç–µ—Å—Ç –¥–ª—è –¥–≤—É—Ö –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –≤—ã–±–æ—Ä–æ–∫.\n",
    "- –û—Ü–µ–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ç–µ—Å—Ç–∞ –∏ —Å–¥–µ–ª–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–µ –≤—ã–≤–æ–¥—ã.\n",
    "- –ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω—ã–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è –Ω–∞–±–ª—é–¥–∞–µ–º–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "728986ea",
   "metadata": {
    "id": "728986ea"
   },
   "source": [
    "## –û–ø–∏—Å–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö\n",
    "\n",
    "–¢–∞–±–ª–∏—Ü–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —Ç–µ—Å—Ç–æ–≤. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–∞:\n",
    "- `user_id` ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è;\n",
    "-  `group` ‚Äî –≥—Ä—É–ø–ø–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è;\n",
    "- `ab_test` ‚Äî –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–µ—Å—Ç–∞;\n",
    "-  `device` ‚Äî —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ, —Å –∫–æ—Ç–æ—Ä–æ–≥–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è.\n",
    "\n",
    "–ê—Ä—Ö–∏–≤ —Å –æ–¥–Ω–∏–º `csv`\\-—Ñ–∞–π–ª–æ–º, –≤ –∫–æ—Ç–æ—Ä–æ–º —Å–æ–±—Ä–∞–Ω—ã —Å–æ–±—ã—Ç–∏—è 2020 –≥–æ–¥–∞; –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–∞:\n",
    "- `user_id` ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è;\n",
    "-  `event_dt` ‚Äî –¥–∞—Ç–∞ –∏ –≤—Ä–µ–º—è —Å–æ–±—ã—Ç–∏—è;\n",
    "-  `event_name` ‚Äî —Ç–∏–ø —Å–æ–±—ã—Ç–∏—è;\n",
    "-  `details` ‚Äî –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ —Å–æ–±—ã—Ç–∏–∏."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4fecaf95",
   "metadata": {
    "id": "4fecaf95"
   },
   "source": [
    "## –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø—Ä–æ–µ–∫—Ç–∞\n",
    "\n",
    "–û—Å–Ω–æ–≤–Ω—ã–µ —à–∞–≥–∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è:\n",
    "\n",
    "- –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –ø–µ—Ä–≤–∏—á–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö\n",
    "- –§–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞ –≥–∏–ø–æ—Ç–µ–∑\n",
    "- –í—ã–±–æ—Ä –∏ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ç–µ—Å—Ç–∞\n",
    "- –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤\n",
    "- –ó–∞–∫–ª—é—á–µ–Ω–∏–µ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏\n",
    "---"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c5d3a2b4",
   "metadata": {},
   "source": [
    "<div class=\"alert alert-block alert-success\">‚úîÔ∏è\n",
    "    \n",
    "\n",
    "__–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ—Ç —Ä–µ–≤—å—é–µ—Ä–∞ ‚Ññ1__ –•–æ—Ä–æ—à–µ–µ –≤—Å—Ç—É–ø–ª–µ–Ω–∏–µ!\n",
    "    \n",
    "–í –Ω—ë–º –µ—Å—Ç—å –≤—Å—ë, —á—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ, —á—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å —Å—É—Ç—å –ø—Ä–æ–µ–∫—Ç–∞ —Å –ø–µ—Ä–≤—ã—Ö —Å—Ç—Ä–æ–∫ –æ—Ç—á—ë—Ç–∞!"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6f7d21d6",
   "metadata": {
    "id": "6f7d21d6"
   },
   "source": [
    "## 1. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–æ —Å –Ω–∏–º–∏\n",
    "\n",
    "–ó–∞–≥—Ä—É–∑–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ –ú–æ—Å–∫–≤—ã –∏ –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥–∞ c –∏—Ö –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é (—Å—É–º–º–æ–π —á–∞—Å–æ–≤ —á—Ç–µ–Ω–∏—è –∏ –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏—è) –∏–∑ —Ñ–∞–π–ª–∞ `/datasets/yandex_knigi_data.csv`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "f68a7419",
   "metadata": {
    "id": "f68a7419"
   },
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import scipy.stats as stats\n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "39620022",
   "metadata": {},
   "outputs": [],
   "source": [
    "df = pd.read_csv('/datasets/yandex_knigi_data.csv')"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "30f1d068",
   "metadata": {},
   "source": [
    "<div class=\"alert alert-block alert-success\">‚úîÔ∏è\n",
    "    \n",
    "\n",
    "__–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ—Ç —Ä–µ–≤—å—é–µ—Ä–∞ ‚Ññ1__\n",
    "    \n",
    "–î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∑–∏–ª–∏.\n",
    "    \n",
    "–ü—Ä–∏ —Å—á–∏—Ç—ã–≤–∞–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ñ–∞–π–ª–∞ –∑–¥–æ—Ä–æ–≤–æ –ø–µ—Ä–µ—Å—Ç—Ä–∞—Ö–æ–≤—ã–≤–∞—Ç—å —Å–µ–±—è –æ—Ç –æ—à–∏–±–æ–∫, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Å –Ω–µ–≤–µ—Ä–Ω—ã–º —É–∫–∞–∑–∞–Ω–∏–µ–º –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª—É. –ê –∏–Ω–æ–≥–¥–∞ –±—ã–≤–∞–µ—Ç, —á—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—à—å —Å —Ñ–∞–π–ª–æ–º –ª–æ–∫–∞–ª—å–Ω–æ, –≤—ã–≥—Ä—É–∂–∞–µ—à—å –µ–≥–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä, –æ–∂–∏–¥–∞—è, —á—Ç–æ –æ–Ω –±—É–¥–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –ª–µ–∂–∞—Ç –Ω–∞ —Ç–æ–º –∂–µ —Å–µ—Ä–≤–µ—Ä–µ, –∞ –∫–æ–¥ –ø–∞–¥–∞–µ—Ç —Å –æ—à–∏–±–∫–æ–π, –ø–æ—Ç–æ–º—É —á—Ç–æ –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É –Ω–µ –ø–æ–º–µ–Ω—è–ª—Å—è —Å –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–Ω—ã–π.\n",
    "    \n",
    "–î–ª—è —ç—Ç–æ–≥–æ, –Ω–∞–ø—Ä–∏–º–µ—Ä, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—é `try-except`: —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–±—É–µ—à—å –ª–æ–∫–∞–ª—å–Ω—ã–π –ø—É—Ç—å, –ø—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –æ—à–∏–±–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–µ—Ä–≤–µ—Ä–Ω—ã–π –ø—É—Ç—å (–ø–æ–¥—Ä–æ–±–Ω–µ–µ –º–æ–∂–µ—à—å –ø–æ—á–∏—Ç–∞—Ç—å —Ç—É—Ç: https://pythonworld.ru/tipy-dannyx-v-python/isklyucheniya-v-python-konstrukciya-try-except-dlya-obrabotki-isklyuchenij.html).\n",
    "    \n",
    "–ù–æ –µ—â–µ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É `os` - –µ—ë –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–æ–∑–≤–æ–ª–∏—Ç —Ç–µ–±–µ –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —É–∫–∞–∑–∞–Ω–Ω—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π (—á—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω–æ –ø—Ä–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π —Ä–∞–±–æ—Ç–∞ –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–º –∏ —Å–µ—Ç–µ–≤–æ–º –æ–∫—Ä—É–∂–µ–Ω–∏–∏) –∏ –∑–∞–≥—Ä—É–∂–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏, –∏–∑–±–µ–≥–∞—è –æ—à–∏–±–æ–∫. –ö–∞–∫ –ø—Ä–∏–º–µ—Ä:\n",
    "    \n",
    "    import os\n",
    "\n",
    "    pth1 = '/folder_1/data.csv'\n",
    "    pth2 = '/folder_2/data.csv'\n",
    "    \n",
    "    if os.path.exists(pth1):\n",
    "        query_1 = pd.read_csv(pth1)\n",
    "    elif os.path.exists(pth2):\n",
    "        query_1 = pd.read_csv(pth2)\n",
    "    else:\n",
    "        print('Something is wrong')\n",
    "\n",
    "–ï—â—ë –Ω–∞ —ç—Ç–∞–ø–µ —Å—á–∏—Ç—ã–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –º–æ–∂–Ω–æ —Å–ø–∞—Ä—Å–∏—Ç—å –¥–∞—Ç—É: –∑–∞ —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –æ—Ç–≤–µ—á–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä `parse_dates` –º–µ—Ç–æ–¥–∞ `read_csv()`, –≤ –Ω–µ–≥–æ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å —Å–ø–∏—Å–æ–∫ —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º –ø–æ–ª–µ–π-–¥–∞—Ç, –∏ –≤ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ —Å–ª—É—á–∞–µ–≤ –¥–∞—Ç–∞ –±—É–¥–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∞ –≤ –Ω—É–∂–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Å—Ä–∞–∑—É:)\n",
    "–¢–∞–∫–∂–µ –Ω–∞ —ç—Ç–∞–ø–µ —Å—á–∏—Ç—ã–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å –∏–Ω–¥–µ–∫—Å-—Å—Ç–æ–ª–±–µ—Ü - –∑–∞ —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –æ—Ç–≤–µ—á–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä `index_col`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "3e4d0814",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Unnamed: 0</th>\n",
       "      <th>city</th>\n",
       "      <th>puid</th>\n",
       "      <th>hours</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>–ú–æ—Å–∫–≤–∞</td>\n",
       "      <td>9668</td>\n",
       "      <td>26.167776</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>–ú–æ—Å–∫–≤–∞</td>\n",
       "      <td>16598</td>\n",
       "      <td>82.111217</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>–ú–æ—Å–∫–≤–∞</td>\n",
       "      <td>80401</td>\n",
       "      <td>4.656906</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>–ú–æ—Å–∫–≤–∞</td>\n",
       "      <td>140205</td>\n",
       "      <td>1.840556</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>–ú–æ—Å–∫–≤–∞</td>\n",
       "      <td>248755</td>\n",
       "      <td>151.326434</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Unnamed: 0    city    puid       hours\n",
       "0           0  –ú–æ—Å–∫–≤–∞    9668   26.167776\n",
       "1           1  –ú–æ—Å–∫–≤–∞   16598   82.111217\n",
       "2           2  –ú–æ—Å–∫–≤–∞   80401    4.656906\n",
       "3           3  –ú–æ—Å–∫–≤–∞  140205    1.840556\n",
       "4           4  –ú–æ—Å–∫–≤–∞  248755  151.326434"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "df8451b9",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 8784 entries, 0 to 8783\n",
      "Data columns (total 4 columns):\n",
      " #   Column      Non-Null Count  Dtype  \n",
      "---  ------      --------------  -----  \n",
      " 0   Unnamed: 0  8784 non-null   int64  \n",
      " 1   city        8784 non-null   object \n",
      " 2   puid        8784 non-null   int64  \n",
      " 3   hours       8784 non-null   float64\n",
      "dtypes: float64(1), int64(2), object(1)\n",
      "memory usage: 274.6+ KB\n"
     ]
    }
   ],
   "source": [
    "df.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "6c05a191",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.duplicated().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "ef63c38b",
   "metadata": {},
   "outputs": [],
   "source": [
    "duplicate_users = df['puid'].duplicated()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "cf583c35",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "244"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df['puid'].duplicated().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "3e02f15a",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Unnamed: 0</th>\n",
       "      <th>city</th>\n",
       "      <th>puid</th>\n",
       "      <th>hours</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>35</th>\n",
       "      <td>35</td>\n",
       "      <td>–ú–æ—Å–∫–≤–∞</td>\n",
       "      <td>2637041</td>\n",
       "      <td>10.317371</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6247</th>\n",
       "      <td>6247</td>\n",
       "      <td>–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥</td>\n",
       "      <td>2637041</td>\n",
       "      <td>3.883926</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>134</th>\n",
       "      <td>134</td>\n",
       "      <td>–ú–æ—Å–∫–≤–∞</td>\n",
       "      <td>9979490</td>\n",
       "      <td>32.415573</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6274</th>\n",
       "      <td>6274</td>\n",
       "      <td>–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥</td>\n",
       "      <td>9979490</td>\n",
       "      <td>1.302997</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>145</th>\n",
       "      <td>145</td>\n",
       "      <td>–ú–æ—Å–∫–≤–∞</td>\n",
       "      <td>10597984</td>\n",
       "      <td>42.931506</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6195</th>\n",
       "      <td>6195</td>\n",
       "      <td>–ú–æ—Å–∫–≤–∞</td>\n",
       "      <td>1130000020425037</td>\n",
       "      <td>0.310556</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8775</th>\n",
       "      <td>8775</td>\n",
       "      <td>–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥</td>\n",
       "      <td>1130000023864516</td>\n",
       "      <td>14.384722</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6202</th>\n",
       "      <td>6202</td>\n",
       "      <td>–ú–æ—Å–∫–≤–∞</td>\n",
       "      <td>1130000023864516</td>\n",
       "      <td>142.830085</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6210</th>\n",
       "      <td>6210</td>\n",
       "      <td>–ú–æ—Å–∫–≤–∞</td>\n",
       "      <td>1130000028554332</td>\n",
       "      <td>11.277554</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8779</th>\n",
       "      <td>8779</td>\n",
       "      <td>–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥</td>\n",
       "      <td>1130000028554332</td>\n",
       "      <td>4.107774</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>488 rows √ó 4 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      Unnamed: 0             city              puid       hours\n",
       "35            35           –ú–æ—Å–∫–≤–∞           2637041   10.317371\n",
       "6247        6247  –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥           2637041    3.883926\n",
       "134          134           –ú–æ—Å–∫–≤–∞           9979490   32.415573\n",
       "6274        6274  –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥           9979490    1.302997\n",
       "145          145           –ú–æ—Å–∫–≤–∞          10597984   42.931506\n",
       "...          ...              ...               ...         ...\n",
       "6195        6195           –ú–æ—Å–∫–≤–∞  1130000020425037    0.310556\n",
       "8775        8775  –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥  1130000023864516   14.384722\n",
       "6202        6202           –ú–æ—Å–∫–≤–∞  1130000023864516  142.830085\n",
       "6210        6210           –ú–æ—Å–∫–≤–∞  1130000028554332   11.277554\n",
       "8779        8779  –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥  1130000028554332    4.107774\n",
       "\n",
       "[488 rows x 4 columns]"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df[df['puid'].duplicated(keep=False)].sort_values(by='puid')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "def52358",
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "# –°–æ—Ö—Ä–∞–Ω—è–µ–º id –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –¥—É–±–ª–∏—Ä—É—é—â–∏–º–∏—Å—è —Å–µ—Å—Å–∏—è–º–∏\n",
    "user_ids = df[df.duplicated(subset=['puid',])]['puid'].to_list()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "96990349",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "2.857142857142857"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# –ü—Ä–æ–≤–µ—Ä–∏–º –¥–æ–ª—é –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π\n",
    "100 * len(user_ids) / df['puid'].nunique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "893265df",
   "metadata": {},
   "outputs": [],
   "source": [
    "# –°–æ—Ö—Ä–∞–Ω—è–º –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ df\n",
    "x = df.shape[0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "bec3fdbc",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "8296"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# –£–¥–∞–ª—è–µ–º –¥—É–±–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π df\n",
    "df = df[~df['puid'].isin(user_ids)].reset_index(drop=True)\n",
    "df.shape[0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "08a04e1e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "488"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "x - len(df)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "60ea8cfe",
   "metadata": {},
   "source": [
    "<div class=\"alert alert-block alert-danger\">‚úç\n",
    "    \n",
    "\n",
    "__–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ—Ç —Ä–µ–≤—å—é–µ—Ä–∞ ‚Ññ1__\n",
    "\n",
    "    \n",
    "–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—Ä–æ–ø—É—Å–∫–∏, —è–≤–Ω—ã–µ –∏ –Ω–µ—è–≤–Ω—ã–µ –¥—É–±–ª–∏–∫–∞—Ç—ã"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c91799cd",
   "metadata": {},
   "source": [
    "<div class=\"alert alert-info\"> <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞:</b> –ì–æ—Ç–æ–≤–æ</div>"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d3f24eb2",
   "metadata": {},
   "source": [
    "–í –∏—Å—Ö–æ–¥–Ω–æ–º –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–µ —Å–æ–¥–µ—Ä–∂–∞–ª–æ—Å—å 8784 –∑–∞–ø–∏—Å–∏. –í —Ö–æ–¥–µ –∞–Ω–∞–ª–∏–∑–∞ –±—ã–ª–∏ –≤—ã—è–≤–ª–µ–Ω—ã 244 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–º–∏—Å—è puid, —á—Ç–æ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø—Ä–∏–º–µ—Ä–Ω–æ 2.86% –æ—Ç –æ–±—â–µ–≥–æ —á–∏—Å–ª–∞ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. \n",
    "\n",
    "–≠—Ç–æ –ø–æ–ª—å–∑–ª–æ–≤–∞—Ç–µ–ª–∏ –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ø–∞–ª–∏ –≤ –æ–±–µ –≥—Ä—É–ø–ø—ã, –∞ –∏–º–µ–Ω–Ω–æ –æ–¥–∏–Ω —É–Ω–∏–∫–∞–ª—å–Ω—ã–π —é–∑–µ—Ä –ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º –∏ –≤ –ú–æ—Å–∫–≤–µ –∏ –≤ –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥–µ.\n",
    "\n",
    "–î–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –∞–Ω–∞–ª–∏–∑–∞ –≤—Å–µ –∑–∞–ø–∏—Å–∏, –æ—Ç–Ω–æ—Å—è—â–∏–µ—Å—è –∫ –¥—É–±–ª–∏—Ä—É—é—â–∏–º—Å—è puid, –±—ã–ª–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª–µ–Ω—ã. –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –æ—á–∏—Å—Ç–∫–∏ —É–¥–∞–ª–µ–Ω–æ 488 —Å—Ç—Ä–æ–∫, –∏ —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞ —Å–æ—Å—Ç–∞–≤–∏–ª 8296 –∑–∞–ø–∏—Å–µ–π.\n",
    "\n",
    "–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–∫–ª—é—á–∏—Ç—å –∏—Å–∫–∞–∂–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π, –≤—ã–∑–≤–∞–Ω–Ω–æ–µ –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω—ã–º —É—á–µ—Ç–æ–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –æ–¥–Ω–∏—Ö –∏ —Ç–µ—Ö –∂–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "749fe903",
   "metadata": {},
   "source": [
    "<div class=\"alert alert-block alert-danger\">‚úç\n",
    "    \n",
    "\n",
    "__–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ—Ç —Ä–µ–≤—å—é–µ—Ä–∞ ‚Ññ1__\n",
    "\n",
    "    \n",
    "–õ—É—á—à–µ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∞, –≥—Ä–∞—Ñ–∏–∫–∞ (–∏–ª–∏ —Å–µ—Ä–∏–∏ —Ç–µ—Å—Ç–æ–≤) –ø–∏—Å–∞—Ç—å –≤—ã–≤–æ–¥ –ø–æ –ø–æ–ª—É—á–µ–Ω–Ω—ã–º –¥–∞–Ω–Ω—ã–º —Å —É—á–µ—Ç–æ–º –ø–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–π –±–∏–∑–Ω–µ—Å –∑–∞–¥–∞—á–∏ - —Ç–∞–∫ –ø—Ä–æ—â–µ —á–∏—Ç–∞—Ç—å –ø—Ä–æ–µ–∫—Ç, –ø–æ—Å–∫–æ–ª—å–∫—É –±—É–¥—É—â–∏–º –∫–æ–ª–ª–µ–≥–∞–º –∏–ª–∏ –∑–∞–∫–∞–∑—á–∏–∫—É –Ω–µ –Ω–∞–¥–æ –±—É–¥–µ—Ç —Å–∞–º–∏–º –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–∞–∂–¥–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∞, —Ç–µ—Å—Ç–∞ –∏–ª–∏ –≥—Ä–∞—Ñ–∏–∫–∞."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "900381e4",
   "metadata": {},
   "source": [
    "<div class=\"alert alert-info\"> <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞:</b> –ì–æ—Ç–æ–≤–æ</div>"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "956e82e2",
   "metadata": {
    "id": "956e82e2"
   },
   "source": [
    "## 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–∏–ø–æ—Ç–µ–∑—ã –≤ Python\n",
    "\n",
    "–ì–∏–ø–æ—Ç–µ–∑–∞ –∑–≤—É—á–∏—Ç —Ç–∞–∫: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–∑ –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥–∞ –ø—Ä–æ–≤–æ–¥—è—Ç –≤ —Å—Ä–µ–¥–Ω–µ–º –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞ —á—Ç–µ–Ω–∏–µ–º –∏ –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–µ–º –∫–Ω–∏–≥ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏, —á–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–∑ –ú–æ—Å–∫–≤—ã. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ —ç—Ç–æ –¥–æ–∫–∞–∑–∞—Ç—å, –∏—Å–ø–æ–ª—å–∑—É—è –æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω—é—é –ø—Ä–æ–≤–µ—Ä–∫—É –≥–∏–ø–æ—Ç–µ–∑—ã —Å –¥–≤—É–º—è –≤—ã–±–æ—Ä–∫–∞–º–∏:\n",
    "\n",
    "- –ù—É–ª–µ–≤–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞ H‚ÇÄ: –°—Ä–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —á–∞—Å–∞—Ö –≤ –¥–≤—É—Ö –≥—Ä—É–ø–ø–∞—Ö (–ú–æ—Å–∫–≤–∞ –∏ –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥) –Ω–µ —Ä–∞–∑–ª–∏—á–∞–µ—Ç—Å—è.\n",
    "\n",
    "- –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞ H‚ÇÅ: –°—Ä–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥–µ –±–æ–ª—å—à–µ, –∏ —ç—Ç–æ —Ä–∞–∑–ª–∏—á–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º–æ."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b281e627",
   "metadata": {},
   "source": [
    "<div class=\"alert alert-block alert-success\">‚úîÔ∏è\n",
    "    \n",
    "\n",
    "__–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ—Ç —Ä–µ–≤—å—é–µ—Ä–∞ ‚Ññ1__\n",
    "\n",
    "–í–µ—Ä–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –≥–∏–ø–æ—Ç–µ–∑. –¢–∞–∫ –¥–µ—Ä–∂–∞—Ç—å!)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0e9ee825",
   "metadata": {},
   "source": [
    "–í—ã–±–æ—Ä —Ç–µ—Å—Ç–∞\n",
    "–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≥–∏–ø–æ—Ç–µ–∑—ã –æ —Ä–∞–∑–Ω–∏—Ü–µ —Å—Ä–µ–¥–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π –º–µ–∂–¥—É –¥–≤—É–º—è –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–º–∏ –≥—Ä—É–ø–ø–∞–º–∏ ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏–∑ –ú–æ—Å–∫–≤—ã –∏ –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥–∞ ‚Äî –±—ã–ª –≤—ã–±—Ä–∞–Ω t-—Ç–µ—Å—Ç.\n",
    "\n",
    "–ü–æ—á–µ–º—É t-—Ç–µ—Å—Ç:\n",
    "\n",
    "- –¶–µ–ª—å ‚Äî —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π –º–µ–∂–¥—É –¥–≤—É–º—è –≥—Ä—É–ø–ø–∞–º–∏ (–∞ –Ω–µ –º–µ–¥–∏–∞–Ω –∏–ª–∏ —Ä–∞–Ω–≥–æ–≤).\n",
    "- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–∑ –ú–æ—Å–∫–≤—ã –∏ –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥–∞ –Ω–µ –ø–µ—Ä–µ—Å–µ–∫–∞—é—Ç—Å—è. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã ‚Äî –æ–¥–Ω–æ –∏–∑ —É—Å–ª–æ–≤–∏–π –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è t-—Ç–µ—Å—Ç–∞.\n",
    "- –†–∞–∑–º–µ—Ä –≤—ã–±–æ—Ä–∫–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–æ–ª—å—à–æ–π (–≤ –æ–±–µ–∏—Ö –≥—Ä—É–ø–ø–∞—Ö –±–æ–ª–µ–µ 30 –Ω–∞–±–ª—é–¥–µ–Ω–∏–π), —á—Ç–æ –¥–µ–ª–∞–µ—Ç t-—Ç–µ—Å—Ç —É—Å—Ç–æ–π—á–∏–≤—ã–º –¥–∞–∂–µ –ø—Ä–∏ —É–º–µ—Ä–µ–Ω–Ω–æ–º –Ω–∞—Ä—É—à–µ–Ω–∏–∏ –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç–∏.\n",
    "- t-—Ç–µ—Å—Ç —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–µ–µ, —á–µ–º –Ω–µ–ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã.\n",
    "- –ü—Ä–∏ —ç—Ç–æ–º –¥–∞–Ω–Ω—ã–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–µ, —á—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —É—Å–ª–æ–≤–∏—è–º t-—Ç–µ—Å—Ç–∞."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "67956690",
   "metadata": {
    "id": "67956690"
   },
   "outputs": [],
   "source": [
    "# –í—ã–¥–µ–ª–∏–º –≥—Ä—É–ø–ø—ã\n",
    "spb = df[df['city'] == '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥']['hours']\n",
    "msk = df[df['city'] == '–ú–æ—Å–∫–≤–∞']['hours']"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7191d261",
   "metadata": {},
   "source": [
    "<div class=\"alert alert-block alert-danger\">‚úç\n",
    "    \n",
    "\n",
    "__–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ—Ç —Ä–µ–≤—å—é–µ—Ä–∞ ‚Ññ1__\n",
    "\n",
    "\n",
    "    \n",
    "<b>–ù–∞ –¥–æ—Ä–∞–±–æ—Ç–∫—É‚ùå:</b> –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –≤—ã–±–æ—Ä–∞ —Ç–µ—Å—Ç–∞. –ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ ttest, –∞ –Ω–µ U-test? –î–æ–±–∞–≤—å, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞ —ç—Ç—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏ –≤—ã–≤–æ–¥ –ø–æ —Ä–∞–∑–¥–µ–ª—É"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1d3f7856",
   "metadata": {},
   "source": [
    "<div class=\"alert alert-info\"> <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞:</b> –ì–æ—Ç–æ–≤–æ</div>"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "b50f17aa",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "t-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: 0.4499\n",
      "p-value: 0.3264\n"
     ]
    }
   ],
   "source": [
    "# t-—Ç–µ—Å—Ç\n",
    "t_stat, p_value = stats.ttest_ind(spb, msk, alternative='greater')\n",
    "\n",
    "print(f\"t-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: {t_stat:.4f}\")\n",
    "print(f\"p-value: {p_value:.4f}\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "04d537e5",
   "metadata": {},
   "source": [
    "–í—ã–≤–æ–¥\n",
    "–†–µ–∑—É–ª—å—Ç–∞—Ç—ã t-—Ç–µ—Å—Ç–∞ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Å—Ä–µ–¥–Ω–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (–≤ —á–∞—Å–∞—Ö) –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏–∑ –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥–∞ –∏ –ú–æ—Å–∫–≤—ã:\n",
    "\n",
    "t-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: 0.4499\n",
    "\n",
    "p-value: 0.3264\n",
    "\n",
    "–ü—Ä–∏ —É—Ä–æ–≤–Ω–µ –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ Œ± = 0.05 –º—ã –Ω–µ –æ—Ç–≤–µ—Ä–≥–∞–µ–º –Ω—É–ª–µ–≤—É—é –≥–∏–ø–æ—Ç–µ–∑—É. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º—ã—Ö —Ä–∞–∑–ª–∏—á–∏–π –≤ —Å—Ä–µ–¥–Ω–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏–∑ –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥–∞ –∏ –ú–æ—Å–∫–≤—ã –Ω–µ –≤—ã—è–≤–ª–µ–Ω–æ. –ú—ã –Ω–µ –º–æ–∂–µ–º —É—Ç–≤–µ—Ä–∂–¥–∞—Ç—å, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–∑ –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥–∞ –ø—Ä–æ–≤–æ–¥—è—Ç –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏, —á–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–∑ –ú–æ—Å–∫–≤—ã."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6953e84c",
   "metadata": {
    "id": "6953e84c"
   },
   "source": [
    "## 3. –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–ø–∏—Å–∫–∞\n",
    "–ü–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫—É—é –∑–∞–ø–∏—Å–∫—É, –≤ –∫–æ—Ç–æ—Ä–æ–π –æ–ø–∏—à–µ—Ç–µ:\n",
    "\n",
    "- –í—ã–±—Ä–∞–Ω–Ω—ã–π —Ç–∏–ø t-—Ç–µ—Å—Ç–∞ –∏ —É—Ä–æ–≤–µ–Ω—å —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏.\n",
    "\n",
    "- –†–µ–∑—É–ª—å—Ç–∞—Ç —Ç–µ—Å—Ç–∞, –∏–ª–∏ p-value.\n",
    "\n",
    "- –í—ã–≤–æ–¥ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ p-value, —Ç–æ –µ—Å—Ç—å –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—é —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.\n",
    "\n",
    "- –û–¥–Ω—É –∏–ª–∏ –¥–≤–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã, –æ–±—ä—è—Å–Ω—è—é—â–∏–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ea890a54",
   "metadata": {},
   "source": [
    "–ú–µ—Ç–æ–¥:\n",
    "–ü—Ä–∏–º–µ–Ω–∏–º t-—Ç–µ—Å—Ç –°—Ç—å—é–¥–µ–Ω—Ç–∞ –¥–ª—è –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –≤—ã–±–æ—Ä–æ–∫ —Å –æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–µ–π –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–π –≥–∏–ø–æ—Ç–µ–∑–æ–π.\n",
    "–£—Ä–æ–≤–µ–Ω—å —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ ‚Äî 0.05."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a8760acf",
   "metadata": {},
   "source": [
    "–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∞:\n",
    "\n",
    "t-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: 0.4499\n",
    "\n",
    "p-value: 0.3264"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0e4138fb",
   "metadata": {},
   "source": [
    "–í—ã–≤–æ–¥:\n",
    "\n",
    "–¢–∞–∫ –∫–∞–∫ p-value = 0.3264 > 0.05, –º—ã –Ω–µ –æ—Ç–≤–µ—Ä–≥–∞–µ–º –Ω—É–ª–µ–≤—É—é –≥–∏–ø–æ—Ç–µ–∑—É.\n",
    "\n",
    "–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –Ω–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º—ã—Ö –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤ —Ç–æ–≥–æ, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–∑ –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥–∞ –ø—Ä–æ–≤–æ–¥—è—Ç –≤ —Å—Ä–µ–¥–Ω–µ–º –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏–∑ –ú–æ—Å–∫–≤—ã.\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "bfe2b2b5",
   "metadata": {},
   "source": [
    "–í–æ–∑–º–æ–∂–Ω—ã–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è:\n",
    "–ü–æ–≤–µ–¥–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å—Ö–æ–∂–µ –≤ –¥–≤—É—Ö –≥–æ—Ä–æ–¥–∞—Ö, –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —Ä–∞–∑–ª–∏—á–∏—è –≤ LTV. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –ø–ª–∞—Ç–∏—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤–æ, –Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–µ—Ä–≤–∏—Å –ø–æ-—Ä–∞–∑–Ω–æ–º—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–¥–ø–∏—Å–∫–∞ ‚Äî —Ä–∞–¥–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ª—é–±–∏–º—ã—Ö –∫–Ω–∏–≥).\n",
    "\n",
    "–†–∞–∑–Ω–∏—Ü–∞ –≤ LTV –º–µ–∂–¥—É –≥–æ—Ä–æ–¥–∞–º–∏ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω–∞ –Ω–µ —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏, –∞, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Å –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é –ø–æ–¥–ø–∏—Å–∫–∏."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c188a6d2",
   "metadata": {},
   "source": [
    "<div class=\"alert alert-block alert-success\">‚úîÔ∏è\n",
    "    \n",
    "\n",
    "__–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ—Ç —Ä–µ–≤—å—é–µ—Ä–∞ ‚Ññ1__\n",
    "\n",
    "–í–µ—Ä–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö. –ú–æ–ª–æ–¥–µ—Ü"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "hc1d6jVISegz",
   "metadata": {
    "id": "hc1d6jVISegz"
   },
   "source": [
    "----"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "NqOUIYhbrIfC",
   "metadata": {
    "id": "NqOUIYhbrIfC"
   },
   "source": [
    "# –ß–∞—Å—Ç—å 2. –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ A/B-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "tDwMKFNGsClr",
   "metadata": {
    "id": "tDwMKFNGsClr"
   },
   "source": [
    "–¢–µ–ø–µ—Ä—å –≤–∞–º –Ω—É–∂–Ω–æ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥—Ä—É–≥–∏–µ –¥–∞–Ω–Ω—ã–µ. –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ –∫ –≤–∞–º –æ–±—Ä–∞—Ç–∏–ª–∏—Å—å –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª–∏ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–∞ BitMotion Kit, –≤ –∫–æ—Ç–æ—Ä–æ–º –ø—Ä–æ–¥–∞—é—Ç—Å—è –≥–µ–π–º–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã –¥–ª—è —Ç–µ—Ö, –∫—Ç–æ –≤–µ–¥—ë—Ç –∑–¥–æ—Ä–æ–≤—ã–π –æ–±—Ä–∞–∑ –∂–∏–∑–Ω–∏. –£ –Ω–µ–≥–æ –µ—Å—Ç—å —Å–≤–æ—è —Ü–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è, –¥–∞–∂–µ –ø–æ—è–≤–∏–ª–∏—Å—å —Ö–∏—Ç—ã –ø—Ä–æ–¥–∞–∂: —ç—Å–ø–∞–Ω–¥–µ—Ä —Å–æ —Å—á—ë—Ç—á–∏–∫–æ–º –∏ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ–º, —Ç–∞–∫ –∏ –ø–æ–¥—Å—Ç–æ–ª—å–Ω—ã–π –≤–µ–ª–æ—Ç—Ä–µ–Ω–∞–∂—ë—Ä —Å Bluetooth.\n",
    "\n",
    "–í –±—É–¥—É—â–µ–º –∫–æ–º–ø–∞–Ω–∏—è —Ö–æ—á–µ—Ç —Ä–∞—Å—à–∏—Ä–∏—Ç—å –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç —Ç–æ–≤–∞—Ä–æ–≤. –ù–æ –ø–µ—Ä–µ–¥ —ç—Ç–∏–º –Ω—É–∂–Ω–æ —Ä–µ—à–∏—Ç—å –æ–¥–Ω—É –ø—Ä–æ–±–ª–µ–º—É. –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –æ–Ω–ª–∞–π–Ω-–º–∞–≥–∞–∑–∏–Ω–∞ —Å–ª–∏—à–∫–æ–º —Å–ª–æ–∂–µ–Ω –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π ‚Äî –æ–± —ç—Ç–æ–º –≥–æ–≤–æ—Ä—è—Ç –æ—Ç–∑—ã–≤—ã.\n",
    "\n",
    "–ß—Ç–æ–±—ã –ø—Ä–∏–≤–ª–µ—á—å –Ω–æ–≤—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ —É–≤–µ–ª–∏—á–∏—Ç—å —á–∏—Å–ª–æ –ø—Ä–æ–¥–∞–∂, –≤–ª–∞–¥–µ–ª—å—Ü—ã –º–∞–≥–∞–∑–∏–Ω–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–ª–∏ –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é —Å–∞–π—Ç–∞ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–∏ –µ–≥–æ –Ω–∞ —á–∞—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –ü–æ –∑–∞–¥—É–º–∫–µ, —ç—Ç–æ —Ä–µ—à–µ–Ω–∏–µ –¥–æ–∫–∞–∑—É–µ–º–æ –ø–æ–≤—ã—Å–∏—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–≤–µ—Ä—à–∞—Ç –ø–æ–∫—É–ø–∫—É.\n",
    "\n",
    "–í–∞—à–∞ –∑–∞–¥–∞—á–∞ ‚Äî –ø—Ä–æ–≤–µ—Å—Ç–∏ –æ—Ü–µ–Ω–∫—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ A/B-—Ç–µ—Å—Ç–∞. –í –≤–∞—à–µ–º —Ä–∞—Å–ø–æ—Ä—è–∂–µ–Ω–∏–∏:\n",
    "\n",
    "* –¥–∞–Ω–Ω—ã–µ –æ –¥–µ–π—Å—Ç–≤–∏—è—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ –∏—Ö –Ω–∞ –≥—Ä—É–ø–ø—ã,\n",
    "\n",
    "* —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ.\n",
    "\n",
    "–û—Ü–µ–Ω–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è —Ç–µ—Å—Ç–∞ –∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –µ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "UNXAAyF5r9Rk",
   "metadata": {
    "id": "UNXAAyF5r9Rk"
   },
   "source": [
    "## 1. –û–ø–∏—à–∏—Ç–µ —Ü–µ–ª–∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è.\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "kHx-51yES8bd",
   "metadata": {
    "id": "kHx-51yES8bd"
   },
   "source": [
    "**–¶–µ–ª–∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è**\n",
    "\n",
    "–û—Ü–µ–Ω–∏—Ç—å –≤–ª–∏—è–Ω–∏–µ –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏ —Å–∞–π—Ç–∞ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–∞ BitMotion Kit –Ω–∞ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.\n",
    "\n",
    "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –ª–∏ –Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è —Å–∞–π—Ç–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Å–æ–≤–µ—Ä—à–∏–≤—à–∏—Ö –ø–æ–∫—É–ø–∫—É.\n",
    "\n",
    "–û—Ü–µ–Ω–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è A/B-—Ç–µ—Å—Ç–∞ (—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è –∏ –ø—Ä–æ—á–µ–µ).\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "_CZryx2OsH-s",
   "metadata": {
    "id": "_CZryx2OsH-s"
   },
   "source": [
    "## 2. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ, –æ—Ü–µ–Ω–∏—Ç–µ –∏—Ö —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "DjFcJbeGsTIg",
   "metadata": {
    "id": "DjFcJbeGsTIg"
   },
   "outputs": [],
   "source": [
    "participants = pd.read_csv('https://code.s3.yandex.net/datasets/ab_test_participants.csv')\n",
    "events = pd.read_csv('https://code.s3.yandex.net/datasets/ab_test_events.zip',\n",
    "                     parse_dates=['event_dt'], low_memory=False)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cd6bb1c0",
   "metadata": {},
   "source": [
    "<div class=\"alert alert-block alert-success\">‚úîÔ∏è\n",
    "    \n",
    "\n",
    "__–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ—Ç —Ä–µ–≤—å—é–µ—Ä–∞ ‚Ññ1__ –ú–æ–ª–æ–¥–µ—Ü, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å `low_memory=False` –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "3ec636d9",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 14525 entries, 0 to 14524\n",
      "Data columns (total 4 columns):\n",
      " #   Column   Non-Null Count  Dtype \n",
      "---  ------   --------------  ----- \n",
      " 0   user_id  14525 non-null  object\n",
      " 1   group    14525 non-null  object\n",
      " 2   ab_test  14525 non-null  object\n",
      " 3   device   14525 non-null  object\n",
      "dtypes: object(4)\n",
      "memory usage: 454.0+ KB\n"
     ]
    }
   ],
   "source": [
    "participants.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "90e1ec26",
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 787286 entries, 0 to 787285\n",
      "Data columns (total 4 columns):\n",
      " #   Column      Non-Null Count   Dtype         \n",
      "---  ------      --------------   -----         \n",
      " 0   user_id     787286 non-null  object        \n",
      " 1   event_dt    787286 non-null  datetime64[ns]\n",
      " 2   event_name  787286 non-null  object        \n",
      " 3   details     249022 non-null  object        \n",
      "dtypes: datetime64[ns](1), object(3)\n",
      "memory usage: 24.0+ MB\n"
     ]
    }
   ],
   "source": [
    "events.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "6f42913b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['interface_eu_test', 'recommender_system_test'], dtype=object)"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "participants['ab_test'].unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "137ad1e1",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "887"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "participants['user_id'].duplicated().sum()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "CnzA-efasUrk",
   "metadata": {
    "id": "CnzA-efasUrk"
   },
   "source": [
    "## 3. –ü–æ —Ç–∞–±–ª–∏—Ü–µ `ab_test_participants` –æ—Ü–µ–Ω–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è —Ç–µ—Å—Ç–∞:\n",
    "\n",
    "   3\\.1 –í—ã–¥–µ–ª–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —É—á–∞—Å—Ç–≤—É—é—â–∏—Ö –≤ —Ç–µ—Å—Ç–µ, –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:\n",
    "\n",
    "   - —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è,\n",
    "\n",
    "   - —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ –≥—Ä—É–ø–ø–∞–º —Ç–µ—Å—Ç–∞,\n",
    "\n",
    "   - –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–π —Å –∫–æ–Ω–∫—É—Ä–∏—Ä—É—é—â–∏–º —Ç–µ—Å—Ç–æ–º (–Ω–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —É—á–∞—Å—Ç–≤—É—é—â–∏—Ö –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –≤ –¥–≤—É—Ö —Ç–µ—Å—Ç–æ–≤—ã—Ö –≥—Ä—É–ø–ø–∞—Ö)."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "faaf81e3",
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['B', 'A'], dtype=object)"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "participants['group'].unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "aNa3zHrKslEN",
   "metadata": {
    "id": "aNa3zHrKslEN",
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "B    5467\n",
       "A    5383\n",
       "Name: group, dtype: int64"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π\n",
    "interface_test = participants[participants['ab_test'] == 'interface_eu_test']\n",
    "interface_test['group'].value_counts()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "96cbddd9",
   "metadata": {},
   "source": [
    "<div class=\"alert alert-block alert-success\">‚úîÔ∏è\n",
    "    \n",
    "\n",
    "__–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ—Ç —Ä–µ–≤—å—é–µ—Ä–∞ ‚Ññ1__ –•–æ—Ä–æ—à–æ, –ª–æ–≥–∏ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω—ã –ø–æ –Ω—É–∂–Ω–æ–º—É —Ç–µ—Å—Ç—É"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "286bef45",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "B    0.503871\n",
       "A    0.496129\n",
       "Name: group, dtype: float64"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# –†–∞–≤–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ –≥—Ä—É–ø–ø–∞–º\n",
    "interface_test['group'].value_counts(normalize=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "26a239e3",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "–ß–∏—Å–ª–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —É—á–∞—Å—Ç–≤—É—é—â–∏—Ö –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ç–µ—Å—Ç–∞—Ö: 887\n"
     ]
    }
   ],
   "source": [
    "# –ï—Å—Ç—å –ª–∏ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è —Å –¥—Ä—É–≥–∏–º–∏ —Ç–µ—Å—Ç–∞–º–∏\n",
    "# –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–∑ interface_eu_test\n",
    "interface_test_users = set(interface_test['user_id'])\n",
    "\n",
    "# –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–∑ –¥—Ä—É–≥–∏—Ö —Ç–µ—Å—Ç–æ–≤\n",
    "other_tests = participants[participants['ab_test'] != 'interface_eu_test']\n",
    "other_test_users = set(other_tests['user_id'])\n",
    "\n",
    "# –ü–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è\n",
    "intersecting_users = interface_test_users.intersection(other_test_users)\n",
    "print(f\"–ß–∏—Å–ª–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —É—á–∞—Å—Ç–≤—É—é—â–∏—Ö –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ç–µ—Å—Ç–∞—Ö: {len(intersecting_users)}\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "dce0233f",
   "metadata": {},
   "source": [
    "–≠—Ç–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –º—ã –æ—Å—Ç–∞–≤–ª—è–µ–º, –ø–æ—Ç–æ–º—É —á—Ç–æ \n",
    "- –Ω–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, —á—Ç–æ –¥—Ä—É–≥–∏–µ —Ç–µ—Å—Ç—ã –∑–∞—Ç—Ä–∞–≥–∏–≤–∞–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, –∏ —á—Ç–æ —ç—Ç–æ—Ç –º–æ–∂–µ—Ç –∏—Å–∫–∞–∂–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.\n",
    "- –£–¥–∞–ª—è—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –º—ã —Å–æ–∫—Ä–∞—â–∞–µ–º —Ä–∞–∑–º–µ—Ä –≤—ã–±–æ—Ä–∫–∏ ‚Äî –≤ –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ, –Ω–∞ 887 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.–≠—Ç–æ –º–æ–∂–µ—Ç —Å–Ω–∏–∑–∏—Ç—å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ç–µ—Å—Ç–∞ –∏ –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —Å–∏—Ç—É–∞—Ü–∏–∏, –∫–æ–≥–¥–∞ —Ä–µ–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç –Ω–µ –±—É–¥–µ—Ç –∑–∞–º–µ—á–µ–Ω.\n",
    "- –£—á–∏—Ç—ã–≤–∞—è –∏—Ö –≤ —Ç–µ—Å—Ç–µ, –º—ã –ø—Ä–∏–±–ª–∏–∂–∞–µ–º —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç –∫ —Ä–µ–∞–ª—å–Ω—ã–º —É—Å–ª–æ–≤–∏—è–º, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –≤—ã–≤–æ–¥—ã –±–æ–ª–µ–µ –ø—Ä–∏–∫–ª–∞–¥–Ω—ã–º–∏ –∏ —É—Å—Ç–æ–π—á–∏–≤—ã–º–∏ –∫ \"—à—É–º—É\"."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4f33ddf6",
   "metadata": {},
   "source": [
    "<div class=\"alert alert-block alert-danger\">‚úç\n",
    "    \n",
    "\n",
    "__–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ—Ç —Ä–µ–≤—å—é–µ—Ä–∞ ‚Ññ1__\n",
    "\n",
    "    \n",
    "–ê —á—Ç–æ –¥–µ–ª–∞–µ–º —Å —ç—Ç–∏–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏? –û—Å—Ç–∞–≤–ª—è–µ–º –∏–ª–∏ —É–¥–∞–ª—è–µ–º? –ò –ø–æ—á–µ–º—É"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "09d75241",
   "metadata": {},
   "source": [
    "<div class=\"alert alert-info\"> <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞:</b> –ì–æ—Ç–æ–≤–æ</div>"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "GjulgSrlsqUU",
   "metadata": {
    "id": "GjulgSrlsqUU"
   },
   "source": [
    "3\\.2 –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ —Ç–∞–±–ª–∏—Ü–µ `ab_test_events`:\n",
    "\n",
    "- –æ—Å—Ç–∞–≤—å—Ç–µ —Ç–æ–ª—å–∫–æ —Å–æ–±—ã—Ç–∏—è, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å —É—á–∞—Å—Ç–≤—É—é—â–∏–º–∏ –≤ –∏–∑—É—á–∞–µ–º–æ–º —Ç–µ—Å—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏;"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "QMt0Ybo_swDK",
   "metadata": {
    "id": "QMt0Ybo_swDK"
   },
   "outputs": [],
   "source": [
    "interface_test_events = events[events['user_id'].isin(interface_test_users)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "a7d211f6",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "Int64Index: 79715 entries, 64672 to 780371\n",
      "Data columns (total 4 columns):\n",
      " #   Column      Non-Null Count  Dtype         \n",
      "---  ------      --------------  -----         \n",
      " 0   user_id     79715 non-null  object        \n",
      " 1   event_dt    79715 non-null  datetime64[ns]\n",
      " 2   event_name  79715 non-null  object        \n",
      " 3   details     21075 non-null  object        \n",
      "dtypes: datetime64[ns](1), object(3)\n",
      "memory usage: 3.0+ MB\n"
     ]
    }
   ],
   "source": [
    "interface_test_events.info()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "fBZ4DC2xswZJ",
   "metadata": {
    "id": "fBZ4DC2xswZJ"
   },
   "source": [
    "- –æ–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –≥–æ—Ä–∏–∑–æ–Ω—Ç –∞–Ω–∞–ª–∏–∑–∞: —Ä–∞—Å—Å—á–∏—Ç–∞–π—Ç–µ –≤—Ä–µ–º—è (–ª–∞–π—Ñ—Ç–∞–π–º) —Å–æ–≤–µ—Ä—à–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –ø–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ –æ—Å—Ç–∞–≤—å—Ç–µ —Ç–æ–ª—å–∫–æ —Ç–µ —Å–æ–±—ã—Ç–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –≤ —Ç–µ—á–µ–Ω–∏–µ –ø–µ—Ä–≤—ã—Ö —Å–µ–º–∏ –¥–Ω–µ–π —Å –º–æ–º–µ–Ω—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏;"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "sES4-dKts0Yb",
   "metadata": {
    "id": "sES4-dKts0Yb"
   },
   "outputs": [],
   "source": [
    "# –ü–æ–ª—É—á–∞–µ–º –¥–∞—Ç—ã —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π\n",
    "registrations = interface_test_events[interface_test_events['event_name'] == 'registration']\n",
    "registrations = registrations[['user_id', 'event_dt']].rename(columns={'event_dt': 'registration_dt'})"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "045d5a1e",
   "metadata": {},
   "outputs": [],
   "source": [
    "# –û–±—ä–µ–¥–∏–Ω–∏–º —Å–æ–±—ã—Ç–∏—è —Å –¥–∞—Ç–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏\n",
    "interface_test_events = interface_test_events.merge(registrations, on='user_id', how='left')\n",
    "\n",
    "# –î–æ–±–∞–≤–∏–º –∫–æ–ª–æ–Ω–∫—É —Å –ª–∞–π—Ñ—Ç–∞–π–º–æ–º ‚Äî —Ä–∞–∑–Ω–∏—Ü–µ–π –º–µ–∂–¥—É —Å–æ–±—ã—Ç–∏–µ–º –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–µ–π –≤ –¥–Ω—è—Ö\n",
    "interface_test_events['lifetime_days'] = (interface_test_events['event_dt'] - interface_test_events['registration_dt']).dt.days"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "076cda58",
   "metadata": {},
   "outputs": [],
   "source": [
    "# –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–ª—å–∫–æ —Å–æ–±—ã—Ç–∏—è —Å –ª–∞–π—Ñ—Ç–∞–π–º–æ–º –¥–æ 7 –¥–Ω–µ–π (–≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ)\n",
    "interface_test_events_7d = interface_test_events[interface_test_events['lifetime_days'] <= 7]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7cf1df48",
   "metadata": {},
   "source": [
    "–û—Ü–µ–Ω–∏—Ç–µ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ—Å—Ç—å –≤—ã–±–æ—Ä–∫–∏ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ A/B-—Ç–µ—Å—Ç–∞. –ó–∞–¥–∞–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:\n",
    "\n",
    "- –±–∞–∑–æ–≤—ã–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ ‚Äî 30%,\n",
    "\n",
    "- –º–æ—â–Ω–æ—Å—Ç—å —Ç–µ—Å—Ç–∞ ‚Äî 80%,\n",
    "\n",
    "- –¥–æ—Å—Ç–æ–≤–µ—Ä–Ω–æ—Å—Ç—å —Ç–µ—Å—Ç–∞ ‚Äî 95%."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "7d97b466",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "–ù–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø–µ: 1376\n"
     ]
    }
   ],
   "source": [
    "from statsmodels.stats.power import NormalIndPower\n",
    "from statsmodels.stats.proportion import proportion_effectsize\n",
    "\n",
    "# –ø–∞—Ä–∞–º–µ—Ç—Ä—ã\n",
    "baseline = 0.3          # –±–∞–∑–æ–≤–∞—è –∫–æ–Ω–≤–µ—Ä—Å–∏—è\n",
    "target = 0.35           # –æ–∂–∏–¥–∞–µ–º–∞—è –∫–æ–Ω–≤–µ—Ä—Å–∏—è –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π\n",
    "alpha = 0.05            # —É—Ä–æ–≤–µ–Ω—å –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏\n",
    "power = 0.8             # –º–æ—â–Ω–æ—Å—Ç—å —Ç–µ—Å—Ç–∞\n",
    "\n",
    "# —Ä–∞–∑–º–µ—Ä —ç—Ñ—Ñ–µ–∫—Ç–∞\n",
    "effect_size = proportion_effectsize(baseline, target)\n",
    "\n",
    "# —Ä–∞—Å—á–µ—Ç –æ–±—ä–µ–º–∞ –≤—ã–±–æ—Ä–∫–∏\n",
    "analysis = NormalIndPower()\n",
    "sample_size = analysis.solve_power(effect_size=effect_size, power=power, alpha=alpha, ratio=1, alternative='two-sided')\n",
    "\n",
    "print(f\"–ù–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø–µ: {round(float(sample_size))}\")\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "SadyUDgZs0t3",
   "metadata": {
    "id": "SadyUDgZs0t3"
   },
   "source": [
    "- —Ä–∞—Å—Å—á–∏—Ç–∞–π—Ç–µ –¥–ª—è –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π, —Å–¥–µ–ª–∞–≤—à–∏—Ö –ø–æ–∫—É–ø–∫—É, –∏ –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "7ph853Xks4sy",
   "metadata": {
    "id": "7ph853Xks4sy",
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "group\n",
       "A    5383\n",
       "B    5467\n",
       "Name: user_id, dtype: int64"
      ]
     },
     "execution_count": 31,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø–µ\n",
    "total_users_by_group = interface_test[['user_id', 'group']].drop_duplicates().groupby('group')['user_id'].count()\n",
    "total_users_by_group"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "7f373489",
   "metadata": {},
   "outputs": [],
   "source": [
    "interface_test_events = interface_test_events.merge(interface_test, on='user_id', how='left')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "ce310080",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "group\n",
       "A    1766\n",
       "B    1931\n",
       "Name: user_id, dtype: int64"
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Å–æ–≤–µ—Ä—à–∏–≤—à–∏—Ö –ø–æ–∫—É–ø–∫—É –≤ –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø–µ\n",
    "purchases_by_group = (\n",
    "    interface_test_events[interface_test_events['event_name'] == 'purchase']\n",
    "    .groupby('group')['user_id']\n",
    "    .nunique()\n",
    ")\n",
    "purchases_by_group"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "sh1JpGvAs5E3",
   "metadata": {
    "id": "sh1JpGvAs5E3"
   },
   "source": [
    "- —Å–¥–µ–ª–∞–π—Ç–µ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –æ–±—â–∏–π –≤—ã–≤–æ–¥ –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –≤ —Ç–µ—Å—Ç–æ–≤–æ–π –≥—Ä—É–ø–ø–µ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "hHTHPkJYs8mE",
   "metadata": {
    "id": "hHTHPkJYs8mE"
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "group\n",
       "A    32.81\n",
       "B    35.32\n",
       "Name: user_id, dtype: float64"
      ]
     },
     "execution_count": 34,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# –†–∞—Å—á—ë—Ç –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –¥–ª—è –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã\n",
    "conversion_by_group = (purchases_by_group / total_users_by_group * 100).round(2)\n",
    "conversion_by_group"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "1d6df64a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "2.51"
      ]
     },
     "execution_count": 35,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "uplift_pp = (conversion_by_group['B'] - conversion_by_group['A']).round(2)\n",
    "uplift_pp"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "fbb25b40",
   "metadata": {},
   "source": [
    "<div class=\"alert alert-block alert-danger\">‚úç\n",
    "    \n",
    "\n",
    "__–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ—Ç —Ä–µ–≤—å—é–µ—Ä–∞ ‚Ññ1__\n",
    "\n",
    "    \n",
    "–ù–∞ —Å–∫–æ–ª—å–∫–æ –ø—Ä–æ—Ü–µ–Ω—Ç–Ω—ã—Ö –ø—É–Ω–∫—Ç–æ–≤ –≤–∏–¥–µ–Ω –∞–ø–ª–∏—Ñ—Ç —Ç–µ—Å—Ç–æ–≤–æ–π –≥—Ä—É–ø–ø—ã?"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1bf4294f",
   "metadata": {},
   "source": [
    "<div class=\"alert alert-info\"> <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞:</b> –ì–æ—Ç–æ–≤–æ</div>"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "IKZ1Oo3Ws919",
   "metadata": {
    "id": "IKZ1Oo3Ws919"
   },
   "source": [
    "## 4. –ü—Ä–æ–≤–µ–¥–∏—Ç–µ –æ—Ü–µ–Ω–∫—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ A/B-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "dcUdBSmvtC-E",
   "metadata": {
    "id": "dcUdBSmvtC-E"
   },
   "source": [
    "- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –ø–æ–¥—Ö–æ–¥—è—â–∏–º —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–º —Ç–µ—Å—Ç–æ–º, —É—á–∏—Ç—ã–≤–∞—è –≤—Å–µ —ç—Ç–∞–ø—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –≥–∏–ø–æ—Ç–µ–∑."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "66c83dfa",
   "metadata": {},
   "source": [
    "H‚ÇÄ (–Ω—É–ª–µ–≤–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞): –ö–æ–Ω–≤–µ—Ä—Å–∏–∏ –≤ –≥—Ä—É–ø–ø–∞—Ö A –∏ B —Ä–∞–≤–Ω—ã. –¢–æ –µ—Å—Ç—å, —Ä–∞–∑–Ω–∏—Ü–∞ –≤ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç.\n",
    "\n",
    "H‚ÇÅ (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞): –ö–æ–Ω–≤–µ—Ä—Å–∏–∏ –≤ –≥—Ä—É–ø–ø–∞—Ö A –∏ B —Ä–∞–∑–ª–∏—á–∞—é—Ç—Å—è. –¢–æ –µ—Å—Ç—å, —Ä–∞–∑–Ω–∏—Ü–∞ –≤ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9badd533",
   "metadata": {},
   "source": [
    "<div class=\"alert alert-block alert-danger\">‚úç\n",
    "    \n",
    "\n",
    "__–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ—Ç —Ä–µ–≤—å—é–µ—Ä–∞ ‚Ññ1__\n",
    "\n",
    "    \n",
    "–ù–µ —Å–æ–≤—Å–µ–º –ø–æ–Ω—è—Ç–Ω–æ, –∫–∞–∫–∞—è –∫–æ–Ω–≤–µ—Ä—Å–∏–∏, –∫–∞–∫–∏—Ö –≥—Ä—É–ø–ø?"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0cad997b",
   "metadata": {},
   "source": [
    "<div class=\"alert alert-info\"> <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞:</b> –ì–æ—Ç–æ–≤–æ</div>"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "id": "l_KOziBQtL3t",
   "metadata": {
    "id": "l_KOziBQtL3t"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "z-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: -2.7625\n",
      "p-value: 0.0057\n"
     ]
    }
   ],
   "source": [
    "from statsmodels.stats.proportion import proportions_ztest\n",
    "\n",
    "# –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Å–ø–µ—Ö–æ–≤ (–ø–æ–∫—É–ø–æ–∫)\n",
    "successes = [purchases_by_group['A'], purchases_by_group['B']]\n",
    "\n",
    "# –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø–µ\n",
    "totals = [total_users_by_group['A'], total_users_by_group['B']]\n",
    "\n",
    "# –ü—Ä–æ–≤–µ–¥–µ–Ω–∏–µ z-—Ç–µ—Å—Ç–∞\n",
    "z_stat, p_value = proportions_ztest(count=successes, nobs=totals, alternative='two-sided')\n",
    "\n",
    "print(f'z-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: {z_stat:.4f}')\n",
    "print(f'p-value: {p_value:.4f}')\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9jkyKOjgtGoc",
   "metadata": {
    "id": "9jkyKOjgtGoc"
   },
   "source": [
    "- –û–ø–∏—à–∏—Ç–µ –≤—ã–≤–æ–¥—ã –ø–æ –ø—Ä–æ–≤–µ–¥—ë–Ω–Ω–æ–π –æ—Ü–µ–Ω–∫–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ A/B-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è. –ß—Ç–æ –º–æ–∂–Ω–æ —Å–∫–∞–∑–∞—Ç—å –ø—Ä–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã A/B-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è? –ë—ã–ª –ª–∏ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç –æ–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç –≤ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏?"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "npoPPSKytKvR",
   "metadata": {
    "id": "npoPPSKytKvR"
   },
   "source": [
    "## –í—ã–≤–æ–¥—ã –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º A/B-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è\n",
    "\n",
    "–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ç–µ—Å—Ç–∞:\n",
    "- z-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: -2.7625\n",
    "- p-value: 0.0057\n",
    "\n",
    "\n",
    "–¢–∞–∫ –∫–∞–∫ p-value < 0.05, –º—ã –æ—Ç–≤–µ—Ä–≥–∞–µ–º –Ω—É–ª–µ–≤—É—é –≥–∏–ø–æ—Ç–µ–∑—É.\n",
    "–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —Ä–∞–∑–Ω–∏—Ü–∞ –≤ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ A –∏ B —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º–∞.\n",
    "–ö–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –≥—Ä—É–ø–ø–µ B (—Ç–µ—Å—Ç–æ–≤–∞—è) –≤—ã—à–µ, —á–µ–º –≤ –≥—Ä—É–ø–ø–µ A (–∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π):\n",
    "- –ì—Ä—É–ø–ø–∞ A: 32.81%\n",
    "- –ì—Ä—É–ø–ø–∞ B: 35.32%\n",
    "\n",
    "–ê–ø–ª–∏—Ñ—Ç: +2.51 –ø.–ø. (–ø—Ä–æ—Ü–µ–Ω—Ç–Ω—ã—Ö –ø—É–Ω–∫—Ç–∞)\n",
    "\n",
    "### –û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç –ø–æ –¢–ó:\n",
    "- –í —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–º –∑–∞–¥–∞–Ω–∏–∏ —É–∫–∞–∑–∞–Ω–æ, —á—Ç–æ –æ–∂–∏–¥–∞–µ–º—ã–π –ø—Ä–∏—Ä–æ—Å—Ç –¥–æ–ª–∂–µ–Ω —Å–æ—Å—Ç–∞–≤–ª—è—Ç—å –Ω–µ –º–µ–Ω–µ–µ 3 –ø.–ø.\n",
    "- –§–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏—Ä–æ—Å—Ç —Å–æ—Å—Ç–∞–≤–∏–ª —Ç–æ–ª—å–∫–æ 2.51 –ø.–ø.\n",
    "\n",
    "**–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:**\n",
    "\n",
    "- –ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º—ã–π —Ä–æ—Å—Ç, —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏—Ä–æ—Å—Ç –Ω–µ –¥–æ—Å—Ç–∏–≥ –ø–æ—Ä–æ–≥–æ–≤–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è, —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –≤ –≥–∏–ø–æ—Ç–µ–∑–µ (3 –ø.–ø.). –¢–æ –µ—Å—Ç—å –±–∏–∑–Ω–µ—Å-–≥–∏–ø–æ—Ç–µ–∑–∞ –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª–∞—Å—å –ø–æ–ª–Ω–æ—Å—Ç—å—é: —Ç–µ—Å—Ç –ø–æ–∫–∞–∑–∞–ª –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç, –Ω–æ –Ω–µ –≤ –æ–∂–∏–¥–∞–µ–º–æ–º –æ–±—ä—ë–º–µ.\n",
    "\n",
    "### –í—ã–≤–æ–¥:\n",
    "- –ù–æ–≤—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —É–ª—É—á—à–∞–µ—Ç –∫–æ–Ω–≤–µ—Ä—Å–∏—é, –Ω–æ –Ω–µ –Ω–∞—Å—Ç–æ–ª—å–∫–æ, –∫–∞–∫ –±—ã–ª–æ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ.\n",
    "- –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –æ—Ü–µ–Ω–∏—Ç—å, –æ–ø—Ä–∞–≤–¥–∞–Ω –ª–∏ —Ç–∞–∫–æ–π –ø—Ä–∏—Ä–æ—Å—Ç —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è —ç–∫–æ–Ω–æ–º–∏–∫–∏, –∑–∞—Ç—Ä–∞—Ç –Ω–∞ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ –∏ –≤–ª–∏—è–Ω–∏—è –Ω–∞ LTV.\n",
    "\n",
    "–†–µ—à–µ–Ω–∏–µ –æ –≤–Ω–µ–¥—Ä–µ–Ω–∏–∏ —Å–ª–µ–¥—É–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å, —É—á–∏—Ç—ã–≤–∞—è –Ω–µ —Ç–æ–ª—å–∫–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É, –Ω–æ –∏ –±–∏–∑–Ω–µ—Å-–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã.\n",
    "–ï—Å–ª–∏ –¥–∞–∂–µ +2.51 –ø.–ø. –¥–∞—ë—Ç –æ—â—É—Ç–∏–º—É—é –ø—Ä–∏–±—ã–ª—å ‚Äî –º–æ–∂–Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞—Ç—å –∫ –∑–∞–ø—É—Å–∫—É. –ï—Å–ª–∏ –∫—Ä–∏—Ç–∏—á–Ω–æ –∏–º–µ–Ω–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ 3 –ø.–ø. ‚Äî —Å—Ç–æ–∏—Ç –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å —Ç–µ—Å—Ç."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f2b0e7ec",
   "metadata": {},
   "source": [
    "<div class=\"alert alert-block alert-danger\">‚úç\n",
    "    \n",
    "\n",
    "__–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ—Ç —Ä–µ–≤—å—é–µ—Ä–∞ ‚Ññ1__\n",
    "\n",
    "    \n",
    "<b>–ù–∞ –¥–æ—Ä–∞–±–æ—Ç–∫—É‚ùå:</b> –¢—É—Ç —Å—Ç–æ–∏—Ç –æ–ø–∏—Å–∞—Ç—å —Ç–∞–∫–∂–µ –ø—Ä–æ –ø—Ä–æ—Ü–µ–Ω—Ç–Ω—ã–µ –ø—É–Ω–∫—Ç—ã (–¥–æ—Å—Ç–∏–≥–ª–∏ –ª–∏ –º—ã –æ–∂–∏–¥–∞–µ–º–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∏–ª–∏ –Ω–µ—Ç?)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d51f78dd",
   "metadata": {},
   "source": [
    "<div class=\"alert alert-info\"> <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞:</b> –ì–æ—Ç–æ–≤–æ</div>"
   ]
  }
 ],
 "metadata": {
  "ExecuteTimeLog": [
   {
    "duration": 1363,
    "start_time": "2025-04-19T17:12:39.745Z"
   },
   {
    "duration": 38,
    "start_time": "2025-04-19T17:12:58.435Z"
   },
   {
    "duration": 26,
    "start_time": "2025-04-19T17:13:38.989Z"
   },
   {
    "duration": 13,
    "start_time": "2025-04-19T17:13:54.566Z"
   },
   {
    "duration": 7,
    "start_time": "2025-04-19T17:15:02.996Z"
   },
   {
    "duration": 6,
    "start_time": "2025-04-19T17:15:29.345Z"
   },
   {
    "duration": 82,
    "start_time": "2025-04-19T17:19:20.633Z"
   },
   {
    "duration": 1533,
    "start_time": "2025-04-19T17:20:24.322Z"
   },
   {
    "duration": 14,
    "start_time": "2025-04-19T17:25:29.488Z"
   },
   {
    "duration": 144,
    "start_time": "2025-04-19T17:25:48.947Z"
   },
   {
    "duration": 9,
    "start_time": "2025-04-19T18:05:08.488Z"
   },
   {
    "duration": 116,
    "start_time": "2025-04-19T18:05:37.488Z"
   },
   {
    "duration": 5,
    "start_time": "2025-04-19T18:06:01.793Z"
   },
   {
    "duration": 64,
    "start_time": "2025-04-19T18:06:13.072Z"
   },
   {
    "duration": 1191,
    "start_time": "2025-04-19T18:06:17.513Z"
   },
   {
    "duration": 966,
    "start_time": "2025-04-19T18:06:37.856Z"
   },
   {
    "duration": 119,
    "start_time": "2025-04-19T18:07:04.831Z"
   },
   {
    "duration": 5,
    "start_time": "2025-04-19T18:07:05.353Z"
   },
   {
    "duration": 1146,
    "start_time": "2025-04-19T18:07:05.984Z"
   },
   {
    "duration": 54,
    "start_time": "2025-04-19T18:07:21.146Z"
   },
   {
    "duration": 8,
    "start_time": "2025-04-19T18:08:45.231Z"
   },
   {
    "duration": 108,
    "start_time": "2025-04-19T18:09:20.478Z"
   },
   {
    "duration": 115,
    "start_time": "2025-04-19T18:09:29.782Z"
   },
   {
    "duration": 125,
    "start_time": "2025-04-19T18:09:35.073Z"
   },
   {
    "duration": 7,
    "start_time": "2025-04-19T18:13:02.793Z"
   },
   {
    "duration": 5,
    "start_time": "2025-04-19T18:13:36.028Z"
   },
   {
    "duration": 9,
    "start_time": "2025-04-19T18:13:56.302Z"
   },
   {
    "duration": 12,
    "start_time": "2025-04-19T18:14:33.438Z"
   },
   {
    "duration": 8,
    "start_time": "2025-04-19T18:15:01.380Z"
   },
   {
    "duration": 3,
    "start_time": "2025-04-19T18:17:53.566Z"
   },
   {
    "duration": 11,
    "start_time": "2025-04-19T18:18:33.050Z"
   },
   {
    "duration": 79,
    "start_time": "2025-04-19T18:22:59.109Z"
   },
   {
    "duration": 13,
    "start_time": "2025-04-19T18:23:11.174Z"
   },
   {
    "duration": 12,
    "start_time": "2025-04-19T18:23:31.655Z"
   },
   {
    "duration": 23,
    "start_time": "2025-04-19T18:23:35.850Z"
   },
   {
    "duration": 14,
    "start_time": "2025-04-19T18:25:47.093Z"
   },
   {
    "duration": 33,
    "start_time": "2025-04-19T18:26:18.441Z"
   },
   {
    "duration": 23,
    "start_time": "2025-04-19T18:26:34.884Z"
   },
   {
    "duration": 14,
    "start_time": "2025-04-19T18:27:14.584Z"
   },
   {
    "duration": 39,
    "start_time": "2025-04-19T18:31:58.098Z"
   },
   {
    "duration": 9,
    "start_time": "2025-04-19T18:32:24.109Z"
   },
   {
    "duration": 17,
    "start_time": "2025-04-19T18:33:09.765Z"
   },
   {
    "duration": 1338,
    "start_time": "2025-04-20T04:06:08.065Z"
   },
   {
    "duration": 36,
    "start_time": "2025-04-20T04:06:09.405Z"
   },
   {
    "duration": 38,
    "start_time": "2025-04-20T04:06:09.442Z"
   },
   {
    "duration": 6,
    "start_time": "2025-04-20T04:06:09.482Z"
   },
   {
    "duration": 5,
    "start_time": "2025-04-20T04:06:09.490Z"
   },
   {
    "duration": 1959,
    "start_time": "2025-04-20T04:06:09.497Z"
   },
   {
    "duration": 12,
    "start_time": "2025-04-20T04:06:11.458Z"
   },
   {
    "duration": 127,
    "start_time": "2025-04-20T04:06:11.472Z"
   },
   {
    "duration": 5,
    "start_time": "2025-04-20T04:06:11.600Z"
   },
   {
    "duration": 74,
    "start_time": "2025-04-20T04:06:11.607Z"
   },
   {
    "duration": 5,
    "start_time": "2025-04-20T04:06:11.683Z"
   },
   {
    "duration": 11,
    "start_time": "2025-04-20T04:06:11.690Z"
   },
   {
    "duration": 20,
    "start_time": "2025-04-20T04:06:11.702Z"
   },
   {
    "duration": 12,
    "start_time": "2025-04-20T04:06:11.724Z"
   },
   {
    "duration": 81,
    "start_time": "2025-04-20T04:06:11.738Z"
   },
   {
    "duration": 26,
    "start_time": "2025-04-20T04:06:11.820Z"
   },
   {
    "duration": 12,
    "start_time": "2025-04-20T04:06:11.848Z"
   },
   {
    "duration": 33,
    "start_time": "2025-04-20T04:06:11.861Z"
   },
   {
    "duration": 12,
    "start_time": "2025-04-20T04:06:11.895Z"
   },
   {
    "duration": 24,
    "start_time": "2025-04-20T04:06:11.936Z"
   },
   {
    "duration": 108,
    "start_time": "2025-04-20T04:07:01.505Z"
   },
   {
    "duration": 16,
    "start_time": "2025-04-20T04:07:32.221Z"
   },
   {
    "duration": 8,
    "start_time": "2025-04-20T04:09:48.215Z"
   },
   {
    "duration": 10,
    "start_time": "2025-04-20T04:10:35.633Z"
   },
   {
    "duration": 12,
    "start_time": "2025-04-20T04:12:34.617Z"
   },
   {
    "duration": 33,
    "start_time": "2025-04-20T04:13:23.956Z"
   },
   {
    "duration": 8,
    "start_time": "2025-04-20T04:13:26.117Z"
   },
   {
    "duration": 30,
    "start_time": "2025-04-20T04:13:37.176Z"
   },
   {
    "duration": 16,
    "start_time": "2025-04-20T04:13:48.625Z"
   },
   {
    "duration": 5,
    "start_time": "2025-04-20T04:18:11.720Z"
   },
   {
    "duration": 6,
    "start_time": "2025-04-20T04:20:19.099Z"
   },
   {
    "duration": 1165,
    "start_time": "2025-04-20T04:37:08.645Z"
   },
   {
    "duration": 24,
    "start_time": "2025-04-20T04:37:09.812Z"
   },
   {
    "duration": 12,
    "start_time": "2025-04-20T04:37:09.838Z"
   },
   {
    "duration": 7,
    "start_time": "2025-04-20T04:37:09.852Z"
   },
   {
    "duration": 5,
    "start_time": "2025-04-20T04:37:09.860Z"
   },
   {
    "duration": 1453,
    "start_time": "2025-04-20T04:37:09.867Z"
   },
   {
    "duration": 20,
    "start_time": "2025-04-20T04:37:11.322Z"
   },
   {
    "duration": 125,
    "start_time": "2025-04-20T04:37:11.344Z"
   },
   {
    "duration": 5,
    "start_time": "2025-04-20T04:37:11.470Z"
   },
   {
    "duration": 11,
    "start_time": "2025-04-20T04:37:11.478Z"
   },
   {
    "duration": 14,
    "start_time": "2025-04-20T04:37:11.490Z"
   },
   {
    "duration": 11,
    "start_time": "2025-04-20T04:37:11.505Z"
   },
   {
    "duration": 25,
    "start_time": "2025-04-20T04:37:11.517Z"
   },
   {
    "duration": 9,
    "start_time": "2025-04-20T04:37:11.543Z"
   },
   {
    "duration": 140,
    "start_time": "2025-04-20T04:37:11.553Z"
   },
   {
    "duration": 23,
    "start_time": "2025-04-20T04:37:11.695Z"
   },
   {
    "duration": 72,
    "start_time": "2025-04-20T04:37:11.720Z"
   },
   {
    "duration": 32,
    "start_time": "2025-04-20T04:37:11.794Z"
   },
   {
    "duration": 8,
    "start_time": "2025-04-20T04:37:11.827Z"
   },
   {
    "duration": 28,
    "start_time": "2025-04-20T04:37:11.837Z"
   },
   {
    "duration": 12,
    "start_time": "2025-04-20T04:37:11.867Z"
   },
   {
    "duration": 33,
    "start_time": "2025-04-20T04:37:11.880Z"
   },
   {
    "duration": 46,
    "start_time": "2025-04-20T04:37:11.914Z"
   },
   {
    "duration": 6,
    "start_time": "2025-04-20T04:37:11.961Z"
   },
   {
    "duration": 12,
    "start_time": "2025-04-20T04:37:11.968Z"
   },
   {
    "duration": 1179,
    "start_time": "2025-04-20T10:30:39.829Z"
   },
   {
    "duration": 24,
    "start_time": "2025-04-20T10:30:41.010Z"
   },
   {
    "duration": 11,
    "start_time": "2025-04-20T10:30:41.036Z"
   },
   {
    "duration": 7,
    "start_time": "2025-04-20T10:30:41.049Z"
   },
   {
    "duration": 5,
    "start_time": "2025-04-20T10:30:41.058Z"
   },
   {
    "duration": 1476,
    "start_time": "2025-04-20T10:30:41.064Z"
   },
   {
    "duration": 12,
    "start_time": "2025-04-20T10:30:42.542Z"
   },
   {
    "duration": 158,
    "start_time": "2025-04-20T10:30:42.557Z"
   },
   {
    "duration": 4,
    "start_time": "2025-04-20T10:30:42.717Z"
   },
   {
    "duration": 47,
    "start_time": "2025-04-20T10:30:42.723Z"
   },
   {
    "duration": 128,
    "start_time": "2025-04-20T10:30:42.771Z"
   },
   {
    "duration": 123,
    "start_time": "2025-04-20T10:30:42.901Z"
   },
   {
    "duration": 36,
    "start_time": "2025-04-20T10:30:43.026Z"
   },
   {
    "duration": 45,
    "start_time": "2025-04-20T10:30:43.065Z"
   },
   {
    "duration": 100,
    "start_time": "2025-04-20T10:30:43.112Z"
   },
   {
    "duration": 40,
    "start_time": "2025-04-20T10:30:43.214Z"
   },
   {
    "duration": 57,
    "start_time": "2025-04-20T10:30:43.256Z"
   },
   {
    "duration": 57,
    "start_time": "2025-04-20T10:30:43.315Z"
   },
   {
    "duration": 11,
    "start_time": "2025-04-20T10:30:43.374Z"
   },
   {
    "duration": 44,
    "start_time": "2025-04-20T10:30:43.386Z"
   },
   {
    "duration": 30,
    "start_time": "2025-04-20T10:30:43.432Z"
   },
   {
    "duration": 85,
    "start_time": "2025-04-20T10:30:43.464Z"
   },
   {
    "duration": 86,
    "start_time": "2025-04-20T10:30:43.551Z"
   },
   {
    "duration": 38,
    "start_time": "2025-04-20T10:30:43.639Z"
   },
   {
    "duration": 42,
    "start_time": "2025-04-20T10:30:43.679Z"
   },
   {
    "duration": 51,
    "start_time": "2025-04-20T13:00:57.563Z"
   },
   {
    "duration": 1409,
    "start_time": "2025-04-20T13:01:00.938Z"
   },
   {
    "duration": 26,
    "start_time": "2025-04-20T13:01:02.349Z"
   },
   {
    "duration": 13,
    "start_time": "2025-04-20T13:01:04.833Z"
   },
   {
    "duration": 13,
    "start_time": "2025-04-20T13:01:06.410Z"
   },
   {
    "duration": 9,
    "start_time": "2025-04-20T13:02:23.104Z"
   },
   {
    "duration": 7,
    "start_time": "2025-04-20T13:02:36.533Z"
   },
   {
    "duration": 10,
    "start_time": "2025-04-20T13:02:45.214Z"
   },
   {
    "duration": 5,
    "start_time": "2025-04-20T13:03:51.762Z"
   },
   {
    "duration": 13,
    "start_time": "2025-04-20T13:04:49.993Z"
   },
   {
    "duration": 69,
    "start_time": "2025-04-20T13:06:49.879Z"
   },
   {
    "duration": 3,
    "start_time": "2025-04-20T13:07:13.636Z"
   },
   {
    "duration": 28,
    "start_time": "2025-04-20T13:07:13.681Z"
   },
   {
    "duration": 8,
    "start_time": "2025-04-20T13:07:18.761Z"
   },
   {
    "duration": 7,
    "start_time": "2025-04-20T13:09:12.177Z"
   },
   {
    "duration": 5,
    "start_time": "2025-04-20T13:09:33.454Z"
   },
   {
    "duration": 14,
    "start_time": "2025-04-20T13:13:29.254Z"
   },
   {
    "duration": 9,
    "start_time": "2025-04-20T13:13:40.518Z"
   },
   {
    "duration": 5,
    "start_time": "2025-04-20T13:14:31.373Z"
   },
   {
    "duration": 5,
    "start_time": "2025-04-20T13:14:39.534Z"
   },
   {
    "duration": 4,
    "start_time": "2025-04-20T13:18:17.672Z"
   },
   {
    "duration": 5,
    "start_time": "2025-04-20T13:18:32.120Z"
   },
   {
    "duration": 4,
    "start_time": "2025-04-20T13:18:36.027Z"
   },
   {
    "duration": 7,
    "start_time": "2025-04-20T13:18:51.388Z"
   },
   {
    "duration": 10,
    "start_time": "2025-04-20T13:19:06.081Z"
   },
   {
    "duration": 4,
    "start_time": "2025-04-20T13:19:23.245Z"
   },
   {
    "duration": 4,
    "start_time": "2025-04-20T13:19:43.909Z"
   },
   {
    "duration": 5,
    "start_time": "2025-04-20T13:19:59.131Z"
   },
   {
    "duration": 5,
    "start_time": "2025-04-20T13:25:05.829Z"
   },
   {
    "duration": 3,
    "start_time": "2025-04-20T13:25:06.303Z"
   },
   {
    "duration": 6,
    "start_time": "2025-04-20T13:25:07.747Z"
   },
   {
    "duration": 5,
    "start_time": "2025-04-20T13:25:08.368Z"
   },
   {
    "duration": 3,
    "start_time": "2025-04-20T13:26:35.829Z"
   },
   {
    "duration": 9,
    "start_time": "2025-04-20T13:29:11.315Z"
   },
   {
    "duration": 5,
    "start_time": "2025-04-20T13:29:22.605Z"
   },
   {
    "duration": 5,
    "start_time": "2025-04-20T13:29:35.668Z"
   },
   {
    "duration": 7,
    "start_time": "2025-04-20T13:40:56.831Z"
   },
   {
    "duration": 4,
    "start_time": "2025-04-20T13:40:58.634Z"
   },
   {
    "duration": 7,
    "start_time": "2025-04-20T13:41:04.890Z"
   },
   {
    "duration": 5,
    "start_time": "2025-04-20T13:44:02.452Z"
   },
   {
    "duration": 1571,
    "start_time": "2025-04-20T13:44:13.192Z"
   },
   {
    "duration": 13,
    "start_time": "2025-04-20T13:44:15.112Z"
   },
   {
    "duration": 118,
    "start_time": "2025-04-20T13:44:15.637Z"
   },
   {
    "duration": 5,
    "start_time": "2025-04-20T13:44:16.149Z"
   },
   {
    "duration": 7,
    "start_time": "2025-04-20T13:44:17.578Z"
   },
   {
    "duration": 6,
    "start_time": "2025-04-20T13:44:21.943Z"
   },
   {
    "duration": 11,
    "start_time": "2025-04-20T13:44:22.503Z"
   },
   {
    "duration": 29,
    "start_time": "2025-04-20T13:44:25.358Z"
   },
   {
    "duration": 9,
    "start_time": "2025-04-20T13:44:26.144Z"
   },
   {
    "duration": 83,
    "start_time": "2025-04-20T13:52:45.817Z"
   },
   {
    "duration": 23,
    "start_time": "2025-04-20T13:52:46.091Z"
   },
   {
    "duration": 12,
    "start_time": "2025-04-20T13:52:47.013Z"
   },
   {
    "duration": 37,
    "start_time": "2025-04-20T13:52:49.960Z"
   },
   {
    "duration": 10,
    "start_time": "2025-04-20T13:52:50.037Z"
   },
   {
    "duration": 23,
    "start_time": "2025-04-20T13:52:52.959Z"
   },
   {
    "duration": 13,
    "start_time": "2025-04-20T13:53:01.943Z"
   },
   {
    "duration": 36,
    "start_time": "2025-04-20T13:53:02.490Z"
   },
   {
    "duration": 35,
    "start_time": "2025-04-20T13:53:02.923Z"
   },
   {
    "duration": 6,
    "start_time": "2025-04-20T13:53:03.993Z"
   },
   {
    "duration": 5,
    "start_time": "2025-04-20T13:54:06.923Z"
   },
   {
    "duration": 3,
    "start_time": "2025-04-20T13:55:01.241Z"
   },
   {
    "duration": 4,
    "start_time": "2025-04-20T13:55:07.417Z"
   },
   {
    "duration": 5,
    "start_time": "2025-04-20T13:55:31.001Z"
   },
   {
    "duration": 5,
    "start_time": "2025-04-20T13:57:28.248Z"
   },
   {
    "duration": 5,
    "start_time": "2025-04-20T13:57:31.021Z"
   },
   {
    "duration": 5,
    "start_time": "2025-04-20T13:59:05.457Z"
   },
   {
    "duration": 1184,
    "start_time": "2025-04-20T14:09:12.721Z"
   },
   {
    "duration": 37,
    "start_time": "2025-04-20T14:09:13.907Z"
   },
   {
    "duration": 13,
    "start_time": "2025-04-20T14:09:13.946Z"
   },
   {
    "duration": 12,
    "start_time": "2025-04-20T14:09:13.961Z"
   },
   {
    "duration": 14,
    "start_time": "2025-04-20T14:09:13.975Z"
   },
   {
    "duration": 62,
    "start_time": "2025-04-20T14:09:13.991Z"
   },
   {
    "duration": 17,
    "start_time": "2025-04-20T14:09:14.054Z"
   },
   {
    "duration": 16,
    "start_time": "2025-04-20T14:09:14.073Z"
   },
   {
    "duration": 10,
    "start_time": "2025-04-20T14:09:14.091Z"
   },
   {
    "duration": 33,
    "start_time": "2025-04-20T14:09:14.102Z"
   },
   {
    "duration": 15,
    "start_time": "2025-04-20T14:09:14.137Z"
   },
   {
    "duration": 35,
    "start_time": "2025-04-20T14:09:14.153Z"
   },
   {
    "duration": 24,
    "start_time": "2025-04-20T14:09:14.190Z"
   },
   {
    "duration": 44,
    "start_time": "2025-04-20T14:09:14.219Z"
   },
   {
    "duration": 51,
    "start_time": "2025-04-20T14:09:14.265Z"
   },
   {
    "duration": 1619,
    "start_time": "2025-04-20T14:09:14.318Z"
   },
   {
    "duration": 12,
    "start_time": "2025-04-20T14:09:15.939Z"
   },
   {
    "duration": 156,
    "start_time": "2025-04-20T14:09:15.953Z"
   },
   {
    "duration": 6,
    "start_time": "2025-04-20T14:09:16.112Z"
   },
   {
    "duration": 23,
    "start_time": "2025-04-20T14:09:16.121Z"
   },
   {
    "duration": 10,
    "start_time": "2025-04-20T14:09:16.146Z"
   },
   {
    "duration": 10,
    "start_time": "2025-04-20T14:09:16.158Z"
   },
   {
    "duration": 38,
    "start_time": "2025-04-20T14:09:16.170Z"
   },
   {
    "duration": 14,
    "start_time": "2025-04-20T14:09:16.211Z"
   },
   {
    "duration": 97,
    "start_time": "2025-04-20T14:09:16.227Z"
   },
   {
    "duration": 35,
    "start_time": "2025-04-20T14:09:16.326Z"
   },
   {
    "duration": 12,
    "start_time": "2025-04-20T14:09:16.363Z"
   },
   {
    "duration": 52,
    "start_time": "2025-04-20T14:09:16.377Z"
   },
   {
    "duration": 10,
    "start_time": "2025-04-20T14:09:16.431Z"
   },
   {
    "duration": 30,
    "start_time": "2025-04-20T14:09:16.443Z"
   },
   {
    "duration": 12,
    "start_time": "2025-04-20T14:09:16.475Z"
   },
   {
    "duration": 62,
    "start_time": "2025-04-20T14:09:16.488Z"
   },
   {
    "duration": 35,
    "start_time": "2025-04-20T14:09:16.551Z"
   },
   {
    "duration": 5,
    "start_time": "2025-04-20T14:09:16.588Z"
   },
   {
    "duration": 21,
    "start_time": "2025-04-20T14:09:16.595Z"
   },
   {
    "duration": 15,
    "start_time": "2025-04-20T14:09:16.617Z"
   }
  ],
  "colab": {
   "provenance": [],
   "toc_visible": true
  },
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.5"
  },
  "toc": {
   "base_numbering": 1,
   "nav_menu": {},
   "number_sections": true,
   "sideBar": true,
   "skip_h1_title": true,
   "title_cell": "Table of Contents",
   "title_sidebar": "Contents",
   "toc_cell": false,
   "toc_position": {
    "height": "calc(100% - 180px)",
    "left": "10px",
    "top": "150px",
    "width": "281.195px"
   },
   "toc_section_display": true,
   "toc_window_display": true
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
